"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.parseEDNListStream = exports.ParseEDNListSteam = void 0;
const stream = require("stream");
const parse_1 = require("./parse");
class ParseEDNListSteam extends stream.Transform {
    constructor(options) {
        super({ readableObjectMode: true });
        this.parser = new parse_1.EDNListParser(options);
    }
    _transform(chunk, encoding, callback) {
        // TODO encoding
        const values = this.parser.next(chunk.toString());
        for (const val of values) {
            this.push(val);
        }
        if (this.parser.isDone()) {
            this.push(null);
        }
        callback();
    }
}
exports.ParseEDNListSteam = ParseEDNListSteam;
exports.parseEDNListStream = (parseOptions) => {
    return new ParseEDNListSteam(parseOptions);
};
